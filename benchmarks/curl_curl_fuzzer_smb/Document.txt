lib/smb.c
/* SMB request state */
enum smb_req_state {
  SMB_REQUESTING,
  SMB_TREE_CONNECT,
  SMB_OPEN,
  SMB_DOWNLOAD,
  SMB_UPLOAD,
  SMB_CLOSE,
  SMB_TREE_DISCONNECT,
  SMB_DONE
};

lib/smb.h
/* SMB connection state */
enum smb_conn_state {
  SMB_NOT_CONNECTED = 0,
  SMB_CONNECTING,
  SMB_NEGOTIATE,
  SMB_SETUP,
  SMB_CONNECTED
};

/* Link command for each protocol */
clang++ -g -I/src/curl_install/include -I/src/curl_install/utfuzzer -DFUZZ_PROTOCOLS_GOPHER -fsanitize=address -fsanitize-address-use-after-scope -stdlib=libc++ -pthread -Wl,--no-as-needed -Wl,-ldl -Wl,-lm -Wno-unused-command-line-argument -fsanitize=fuzzer-no-link -D_GLIBCXX_USE_CXX11_ABI=0 -Xclang -load -Xclang /opt/FuzzerOCGSanitizer.so -o curl_fuzzer_gopher curl_fuzzer_gopher-curl_fuzzer.o curl_fuzzer_gopher-curl_fuzzer_tlv.o curl_fuzzer_gopher-curl_fuzzer_callback.o  /src/curl_install/lib/libcurl.a -L/src/curl_install/lib /src/curl_install/lib/libnghttp2.a -ldl -lssl -lcrypto -lz /usr/lib/libFuzzingEngine.a -lpthread -lm -pthread
clang++ -g -I/src/curl_install/include -I/src/curl_install/utfuzzer -DFUZZ_PROTOCOLS_ALL -fsanitize=address -fsanitize-address-use-after-scope -stdlib=libc++ -pthread -Wl,--no-as-needed -Wl,-ldl -Wl,-lm -Wno-unused-command-line-argument -fsanitize=fuzzer-no-link -D_GLIBCXX_USE_CXX11_ABI=0 -Xclang -load -Xclang /opt/FuzzerOCGSanitizer.so -o curl_fuzzer curl_fuzzer-curl_fuzzer.o curl_fuzzer-curl_fuzzer_tlv.o curl_fuzzer-curl_fuzzer_callback.o  /src/curl_install/lib/libcurl.a -L/src/curl_install/lib /src/curl_install/lib/libnghttp2.a -ldl -lssl -lcrypto -lz /usr/lib/libFuzzingEngine.a -lpthread -lm -pthread
clang++ -g -I/src/curl_install/include -I/src/curl_install/utfuzzer -DFUZZ_PROTOCOLS_SCP -fsanitize=address -fsanitize-address-use-after-scope -stdlib=libc++ -pthread -Wl,--no-as-needed -Wl,-ldl -Wl,-lm -Wno-unused-command-line-argument -fsanitize=fuzzer-no-link -D_GLIBCXX_USE_CXX11_ABI=0 -Xclang -load -Xclang /opt/FuzzerOCGSanitizer.so -o curl_fuzzer_scp curl_fuzzer_scp-curl_fuzzer.o curl_fuzzer_scp-curl_fuzzer_tlv.o curl_fuzzer_scp-curl_fuzzer_callback.o  /src/curl_install/lib/libcurl.a -L/src/curl_install/lib /src/curl_install/lib/libnghttp2.a -ldl -lssl -lcrypto -lz /usr/lib/libFuzzingEngine.a -lpthread -lm -pthread
clang++ -g -I/src/curl_install/include -I/src/curl_install/utfuzzer -DFUZZ_PROTOCOLS_SMB -fsanitize=address -fsanitize-address-use-after-scope -stdlib=libc++ -pthread -Wl,--no-as-needed -Wl,-ldl -Wl,-lm -Wno-unused-command-line-argument -fsanitize=fuzzer-no-link -D_GLIBCXX_USE_CXX11_ABI=0 -Xclang -load -Xclang /opt/FuzzerOCGSanitizer.so -o curl_fuzzer_smb curl_fuzzer_smb-curl_fuzzer.o curl_fuzzer_smb-curl_fuzzer_tlv.o curl_fuzzer_smb-curl_fuzzer_callback.o  /src/curl_install/lib/libcurl.a -L/src/curl_install/lib /src/curl_install/lib/libnghttp2.a -ldl -lssl -lcrypto -lz /usr/lib/libFuzzingEngine.a -lpthread -lm -pthread
clang++ -g -I/src/curl_install/include -I/src/curl_install/utfuzzer -DFUZZ_PROTOCOLS_POP3 -fsanitize=address -fsanitize-address-use-after-scope -stdlib=libc++ -pthread -Wl,--no-as-needed -Wl,-ldl -Wl,-lm -Wno-unused-command-line-argument -fsanitize=fuzzer-no-link -D_GLIBCXX_USE_CXX11_ABI=0 -Xclang -load -Xclang /opt/FuzzerOCGSanitizer.so -o curl_fuzzer_pop3 curl_fuzzer_pop3-curl_fuzzer.o curl_fuzzer_pop3-curl_fuzzer_tlv.o curl_fuzzer_pop3-curl_fuzzer_callback.o  /src/curl_install/lib/libcurl.a -L/src/curl_install/lib /src/curl_install/lib/libnghttp2.a -ldl -lssl -lcrypto -lz /usr/lib/libFuzzingEngine.a -lpthread -lm -pthread
clang++ -g -I/src/curl_install/include -I/src/curl_install/utfuzzer -DFUZZ_PROTOCOLS_HTTP -fsanitize=address -fsanitize-address-use-after-scope -stdlib=libc++ -pthread -Wl,--no-as-needed -Wl,-ldl -Wl,-lm -Wno-unused-command-line-argument -fsanitize=fuzzer-no-link -D_GLIBCXX_USE_CXX11_ABI=0 -Xclang -load -Xclang /opt/FuzzerOCGSanitizer.so -o curl_fuzzer_http curl_fuzzer_http-curl_fuzzer.o curl_fuzzer_http-curl_fuzzer_tlv.o curl_fuzzer_http-curl_fuzzer_callback.o  /src/curl_install/lib/libcurl.a -L/src/curl_install/lib /src/curl_install/lib/libnghttp2.a -ldl -lssl -lcrypto -lz /usr/lib/libFuzzingEngine.a -lpthread -lm -pthread
clang++ -g -I/src/curl_install/include -I/src/curl_install/utfuzzer -DFUZZ_PROTOCOLS_IMAP -fsanitize=address -fsanitize-address-use-after-scope -stdlib=libc++ -pthread -Wl,--no-as-needed -Wl,-ldl -Wl,-lm -Wno-unused-command-line-argument -fsanitize=fuzzer-no-link -D_GLIBCXX_USE_CXX11_ABI=0 -Xclang -load -Xclang /opt/FuzzerOCGSanitizer.so -o curl_fuzzer_imap curl_fuzzer_imap-curl_fuzzer.o curl_fuzzer_imap-curl_fuzzer_tlv.o curl_fuzzer_imap-curl_fuzzer_callback.o  /src/curl_install/lib/libcurl.a -L/src/curl_install/lib /src/curl_install/lib/libnghttp2.a -ldl -lssl -lcrypto -lz /usr/lib/libFuzzingEngine.a -lpthread -lm -pthread
clang++ -g -I/src/curl_install/include -I/src/curl_install/utfuzzer -DFUZZ_PROTOCOLS_RTMP -fsanitize=address -fsanitize-address-use-after-scope -stdlib=libc++ -pthread -Wl,--no-as-needed -Wl,-ldl -Wl,-lm -Wno-unused-command-line-argument -fsanitize=fuzzer-no-link -D_GLIBCXX_USE_CXX11_ABI=0 -Xclang -load -Xclang /opt/FuzzerOCGSanitizer.so -o curl_fuzzer_rtmp curl_fuzzer_rtmp-curl_fuzzer.o curl_fuzzer_rtmp-curl_fuzzer_tlv.o curl_fuzzer_rtmp-curl_fuzzer_callback.o  /src/curl_install/lib/libcurl.a -L/src/curl_install/lib /src/curl_install/lib/libnghttp2.a -ldl -lssl -lcrypto -lz /usr/lib/libFuzzingEngine.a -lpthread -lm -pthread
clang++ -g -I/src/curl_install/include -I/src/curl_install/utfuzzer -DFUZZ_PROTOCOLS_FTP -fsanitize=address -fsanitize-address-use-after-scope -stdlib=libc++ -pthread -Wl,--no-as-needed -Wl,-ldl -Wl,-lm -Wno-unused-command-line-argument -fsanitize=fuzzer-no-link -D_GLIBCXX_USE_CXX11_ABI=0 -Xclang -load -Xclang /opt/FuzzerOCGSanitizer.so -o curl_fuzzer_ftp curl_fuzzer_ftp-curl_fuzzer.o curl_fuzzer_ftp-curl_fuzzer_tlv.o curl_fuzzer_ftp-curl_fuzzer_callback.o  /src/curl_install/lib/libcurl.a -L/src/curl_install/lib /src/curl_install/lib/libnghttp2.a -ldl -lssl -lcrypto -lz /usr/lib/libFuzzingEngine.a -lpthread -lm -pthread
clang++ -g -I/src/curl_install/include -I/src/curl_install/utfuzzer -DFUZZ_PROTOCOLS_SFTP -fsanitize=address -fsanitize-address-use-after-scope -stdlib=libc++ -pthread -Wl,--no-as-needed -Wl,-ldl -Wl,-lm -Wno-unused-command-line-argument -fsanitize=fuzzer-no-link -D_GLIBCXX_USE_CXX11_ABI=0 -Xclang -load -Xclang /opt/FuzzerOCGSanitizer.so -o curl_fuzzer_sftp curl_fuzzer_sftp-curl_fuzzer.o curl_fuzzer_sftp-curl_fuzzer_tlv.o curl_fuzzer_sftp-curl_fuzzer_callback.o  /src/curl_install/lib/libcurl.a -L/src/curl_install/lib /src/curl_install/lib/libnghttp2.a -ldl -lssl -lcrypto -lz /usr/lib/libFuzzingEngine.a -lpthread -lm -pthread
clang++ -g -I/src/curl_install/include -I/src/curl_install/utfuzzer -DFUZZ_PROTOCOLS_DICT -fsanitize=address -fsanitize-address-use-after-scope -stdlib=libc++ -pthread -Wl,--no-as-needed -Wl,-ldl -Wl,-lm -Wno-unused-command-line-argument -fsanitize=fuzzer-no-link -D_GLIBCXX_USE_CXX11_ABI=0 -Xclang -load -Xclang /opt/FuzzerOCGSanitizer.so -o curl_fuzzer_dict curl_fuzzer_dict-curl_fuzzer.o curl_fuzzer_dict-curl_fuzzer_tlv.o curl_fuzzer_dict-curl_fuzzer_callback.o  /src/curl_install/lib/libcurl.a -L/src/curl_install/lib /src/curl_install/lib/libnghttp2.a -ldl -lssl -lcrypto -lz /usr/lib/libFuzzingEngine.a -lpthread -lm -pthread
clang++ -g -I/src/curl_install/include -I/src/curl_install/utfuzzer -DFUZZ_PROTOCOLS_TFTP -fsanitize=address -fsanitize-address-use-after-scope -stdlib=libc++ -pthread -Wl,--no-as-needed -Wl,-ldl -Wl,-lm -Wno-unused-command-line-argument -fsanitize=fuzzer-no-link -D_GLIBCXX_USE_CXX11_ABI=0 -Xclang -load -Xclang /opt/FuzzerOCGSanitizer.so -o curl_fuzzer_tftp curl_fuzzer_tftp-curl_fuzzer.o curl_fuzzer_tftp-curl_fuzzer_tlv.o curl_fuzzer_tftp-curl_fuzzer_callback.o  /src/curl_install/lib/libcurl.a -L/src/curl_install/lib /src/curl_install/lib/libnghttp2.a -ldl -lssl -lcrypto -lz /usr/lib/libFuzzingEngine.a -lpthread -lm -pthread
clang++ -g -I/src/curl_install/include -I/src/curl_install/utfuzzer -DFUZZ_PROTOCOLS_RTSP -fsanitize=address -fsanitize-address-use-after-scope -stdlib=libc++ -pthread -Wl,--no-as-needed -Wl,-ldl -Wl,-lm -Wno-unused-command-line-argument -fsanitize=fuzzer-no-link -D_GLIBCXX_USE_CXX11_ABI=0 -Xclang -load -Xclang /opt/FuzzerOCGSanitizer.so -o curl_fuzzer_rtsp curl_fuzzer_rtsp-curl_fuzzer.o curl_fuzzer_rtsp-curl_fuzzer_tlv.o curl_fuzzer_rtsp-curl_fuzzer_callback.o  /src/curl_install/lib/libcurl.a -L/src/curl_install/lib /src/curl_install/lib/libnghttp2.a -ldl -lssl -lcrypto -lz /usr/lib/libFuzzingEngine.a -lpthread -lm -pthread
clang++ -g -I/src/curl_install/include -I/src/curl_install/utfuzzer -DFUZZ_PROTOCOLS_HTTPS -fsanitize=address -fsanitize-address-use-after-scope -stdlib=libc++ -pthread -Wl,--no-as-needed -Wl,-ldl -Wl,-lm -Wno-unused-command-line-argument -fsanitize=fuzzer-no-link -D_GLIBCXX_USE_CXX11_ABI=0 -Xclang -load -Xclang /opt/FuzzerOCGSanitizer.so -o curl_fuzzer_https curl_fuzzer_https-curl_fuzzer.o curl_fuzzer_https-curl_fuzzer_tlv.o curl_fuzzer_https-curl_fuzzer_callback.o  /src/curl_install/lib/libcurl.a -L/src/curl_install/lib /src/curl_install/lib/libnghttp2.a -ldl -lssl -lcrypto -lz /usr/lib/libFuzzingEngine.a -lpthread -lm -pthread
clang++ -g -I/src/curl_install/include -I/src/curl_install/utfuzzer -DFUZZ_PROTOCOLS_SMTP -fsanitize=address -fsanitize-address-use-after-scope -stdlib=libc++ -pthread -Wl,--no-as-needed -Wl,-ldl -Wl,-lm -Wno-unused-command-line-argument -fsanitize=fuzzer-no-link -D_GLIBCXX_USE_CXX11_ABI=0 -Xclang -load -Xclang /opt/FuzzerOCGSanitizer.so -o curl_fuzzer_smtp curl_fuzzer_smtp-curl_fuzzer.o curl_fuzzer_smtp-curl_fuzzer_tlv.o curl_fuzzer_smtp-curl_fuzzer_callback.o  /src/curl_install/lib/libcurl.a -L/src/curl_install/lib /src/curl_install/lib/libnghttp2.a -ldl -lssl -lcrypto -lz /usr/lib/libFuzzingEngine.a -lpthread -lm -pthread
clang++ -g -I/src/curl_install/include -I/src/curl_install/utfuzzer -DFUZZ_PROTOCOLS_LDAP -fsanitize=address -fsanitize-address-use-after-scope -stdlib=libc++ -pthread -Wl,--no-as-needed -Wl,-ldl -Wl,-lm -Wno-unused-command-line-argument -fsanitize=fuzzer-no-link -D_GLIBCXX_USE_CXX11_ABI=0 -Xclang -load -Xclang /opt/FuzzerOCGSanitizer.so -o curl_fuzzer_ldap curl_fuzzer_ldap-curl_fuzzer.o curl_fuzzer_ldap-curl_fuzzer_tlv.o curl_fuzzer_ldap-curl_fuzzer_callback.o  /src/curl_install/lib/libcurl.a -L/src/curl_install/lib /src/curl_install/lib/libnghttp2.a -ldl -lssl -lcrypto -lz /usr/lib/libFuzzingEngine.a -lpthread -lm -pthread
clang++ -g -I/src/curl_install/include -I/src/curl_install/utfuzzer -DFUZZ_PROTOCOLS_FILE -fsanitize=address -fsanitize-address-use-after-scope -stdlib=libc++ -pthread -Wl,--no-as-needed -Wl,-ldl -Wl,-lm -Wno-unused-command-line-argument -fsanitize=fuzzer-no-link -D_GLIBCXX_USE_CXX11_ABI=0 -Xclang -load -Xclang /opt/FuzzerOCGSanitizer.so -o curl_fuzzer_file curl_fuzzer_file-curl_fuzzer.o curl_fuzzer_file-curl_fuzzer_tlv.o curl_fuzzer_file-curl_fuzzer_callback.o  /src/curl_install/lib/libcurl.a -L/src/curl_install/lib /src/curl_install/lib/libnghttp2.a -ldl -lssl -lcrypto -lz /usr/lib/libFuzzingEngine.a -lpthread -lm -pthread
